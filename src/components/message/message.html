
<div *ngIf="showPreviousDay()" class="day-separator">
    <div class="line"></div>
    <div class="day">{{ printDay() }}</div>
    <div class="line"></div>
</div>

<div class="message-container" [class.me]="user.datum.id===account.session.id"
    [class.sending]="sending" [class.error]="message.failed">
    <div class="author" *ngIf="showAuthor()">
        <div *ngIf="user.datum.id!==account.session.id" class="avatar" 
            [backgroundImg]="user.datum.avatar | dmsUrl: [50,'x',50]"
            [biToken]="user.datum.avatar+'50'">
            {{ user.datum | userletter }}
        </div>
        <div class="name">{{ user.datum | username:true:true }}</div>
    </div>
    <div class="message-text" [class.notrounded]="_hasNotRoundedBorder()">
        <span class="text" *ngIf="message.text">{{ message.text }}</span>

        <div class="file-container" *ngIf="message.library">
            <file class="file" [file]="message.library" (tap)="emitFileTapped()"></file>
            <div class="progress" [style.width]="message.progress"></div>
        </div>

        <span class="hour">{{ message.created_date | date:'shortTime' }}</span>

        <div class="sending-animation" *ngIf="sending">
            <div></div>
            <div></div>
            <div></div>
        </div>

        <div class="error-text" *ngIf="message.failed">
            <span class="i i-alert"></span>
            <span>Tap here to send again</span>
        </div>
    </div>
    <div class="last-read" *ngIf="lastReadUsers.length">
        <div *ngFor="let id of lastReadUsers" class="avatar" 
            [backgroundImg]="userModel.list[id].datum.avatar | dmsUrl"
            [biToken]="userModel.list[id].datum.avatar+'50'">
            {{ userModel.list[id].datum | userletter }}
        </div>
    </div>
</div>
